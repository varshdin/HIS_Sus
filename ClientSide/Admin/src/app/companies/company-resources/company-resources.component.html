<div>
  <div class="formdiv content mat-elevation-z8">
    <form
      [formGroup]="urlform"
      (submit)="getUrlLists(urlform)"
      style="width: -webkit-fill-available; display: contents"
    >
      <mat-form-field class="inputField">
        <mat-label>{{ companyName }}</mat-label>
        <input
          matInput
          placeholder="Resource Link"
          formControlName="inputUrl"
        />
      </mat-form-field>
      <div
        style="margin-bottom: 1%"
        *ngIf="inputUrl.invalid && inputUrl.errors?.['invalidUrl']"
      >
        URL is invalid
      </div>

      <div style="margin-bottom: 1%">
        <button class="saveButton" type="submit" mat-button>
          Get resources
        </button>
      </div>
    </form>
  </div>
  <div
    *ngIf="extractedLinks | async"
    style="text-align: center; min-height: 500px; margin: 2%"
    class="content mat-elevation-z8"
  >
    <div class="mat-elevation-z8">
      <mat-toolbar color="primary" style="display: block">
        <div class="toolbar-container" style="margin: 0 auto">
          <span style="margin: 10px">Extracted Links </span>
          <span class="example-spacer"></span>
          <span style="margin: 10px" class="add-new-company-button">
            <button mat-button class="menu-button" (click)="downloadAll()">
              Download All
            </button>
          </span>
        </div>
      </mat-toolbar>

      <table
        style="min-height: 500px"
        mat-table
        [dataSource]="extractedLinks | async"
      >
        <!-- Links Column -->
        <ng-container matColumnDef="Links">
          <th mat-header-cell *matHeaderCellDef>Links</th>
          <td mat-cell *matCellDef="let element">{{ element }}</td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="Actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let element; let i = index">
            <button (click)="downloadSingleFile(element, i)" mat-icon-button>
              Download
            </button>
            <button mat-icon-button>Delete</button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </div>
  </div>

  <div
    style="text-align: center; min-height: 500px; margin: 2%"
    class="content mat-elevation-z8"
  >
    <div class="mat-elevation-z8">
      <mat-toolbar color="primary" style="display: block">
        <div class="toolbar-container" style="margin: 0 auto">
          <span style="margin: 10px">Stored Resources </span>
        </div>
      </mat-toolbar>
      <table style="min-height: 500px" mat-table [dataSource]="dataSource">
        <ng-container matColumnDef="filename" style="max-width: 100px">
          <th mat-header-cell *matHeaderCellDef>Filename</th>
          <td
            style="word-wrap: break-word; max-width: 150px; font-size: small"
            mat-cell
            *matCellDef="let element"
          >
            {{ element.filename }}
          </td>
        </ng-container>
        <ng-container matColumnDef="url">
          <th mat-header-cell *matHeaderCellDef>Url</th>
          <td
            style="word-wrap: break-word; max-width: 150px; font-size: small"
            mat-cell
            *matCellDef="let element"
          >
            {{ element.url }}
          </td>
        </ng-container>
        <ng-container matColumnDef="filelocation">
          <th mat-header-cell *matHeaderCellDef>File Location</th>
          <td
            style="word-wrap: break-word; max-width: 150px; font-size: small"
            mat-cell
            *matCellDef="let element"
          >
            {{ element.filelocation }}
          </td>
        </ng-container>

        <ng-container matColumnDef="extension">
          <th mat-header-cell *matHeaderCellDef>Extension</th>
          <td mat-cell *matCellDef="let element">{{ element.extension }}</td>
        </ng-container>

        <ng-container matColumnDef="year">
          <th mat-header-cell *matHeaderCellDef>Year</th>
          <td mat-cell *matCellDef="let element">{{ element.year }}</td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let element; let i = index">
            <button (click)="deleteData(element)" mat-icon-button>
              Delete
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="resourceColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: resourceColumns"></tr>
      </table>
    </div>
  </div>
</div>
